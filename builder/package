#!/bin/bash

#Launcher64 is taken from the Eto.Forms.Mac64 2.5.0-ci-10024 nuget package

BUILDER_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source ${BUILDER_DIR}/helpers
detectversion

function mac()
{
	macdir=${NERVA_DIR}/Bin/Release/Mac/Nerva.Toolkit.Mac.app

	plist=$(sed -e "s/{NERVA_VERSION}/${NERVA_VERSION}/" -e "s/{DISPLAY_NAME}/${NERVA_CODENAME}/" ${BUILDER_DIR}/Info.plist.template)
	echo $plist > ${macdir}/Contents/Info.plist

	cp ${BUILDER_DIR}/logos/nerva-logo-color.icns ${macdir}/Contents/Resources/nerva-logo-color.icns
	cp ${BUILDER_DIR}/logos/nerva-logo-color-2.icns ${macdir}/Contents/Resources/nerva-logo-color-2.icns

	cd ${NERVA_DIR}/Bin/Release/Mac/Nerva.Toolkit.Mac.app
	mkdir -p ${NERVA_DIR}/Bin/output
	zip -r ${NERVA_DIR}/Bin/output/nerva-gui-v${NERVA_VERSION}_osx.zip ./*
}

function windows()
{
	cd ${NERVA_DIR}/Bin/Release/Windows
	mkdir -p ${NERVA_DIR}/Bin/output
	zip -r ${NERVA_DIR}/Bin/output/nerva-gui-v${NERVA_VERSION}_windows.zip ./*
}

function linux()
{
	cd ${NERVA_DIR}/Bin/Release/Linux
	mkdir -p ${NERVA_DIR}/Bin/output
	zip -r ${NERVA_DIR}/Bin/output/nerva-gui-v${NERVA_VERSION}_linux.zip ./*
}

$1
